# Claude Code Instructions

## テストポリシー

### 新機能実装時のテスト要件

新しいAPIエンドポイントや機能を実装する際は、**必ず**以下の手順でテストを作成・実行してください：

1. **機能実装前にテスト計画を立てる**
   - どのようなテストケースが必要か検討
   - 正常系・異常系の両方を考慮

2. **実装と同時にテストを書く**
   - Vitestを使用してユニットテストを作成
   - `src/__tests__/` ディレクトリに配置

3. **テストを実行して確認**
   ```bash
   npm test
   ```
   - すべてのテストがパスすることを確認
   - 既存のテストが壊れていないことを確認

4. **テストカバレッジを確認**
   ```bash
   npm run test:coverage
   ```

### テストが必要な項目

- ✅ すべてのAPIエンドポイント（GET, POST, PUT, DELETE）
- ✅ 認証が必要なエンドポイント（401エラーのテスト）
- ✅ バリデーションエラーのケース（400エラー）
- ✅ データが存在しない場合（404エラー）
- ✅ エッジケース（空配列、境界値など）

### Honoアプリケーションのテスト例

```typescript
import { describe, it, expect } from 'vitest'
import { app } from '../app'

describe('API Tests', () => {
  it('should return 200', async () => {
    const res = await app.request('/api/endpoint')
    expect(res.status).toBe(200)
  })
})
```

## コミットポリシー

- 機能実装とテストを含めてコミット
- テストが全てパスしていることを確認してからコミット
- コミットメッセージには実装内容とテスト内容を明記

## 今回のフィードバック

認証機能を実装しましたが、テストを書いていませんでした。次回からは：

1. 認証エンドポイント（`/auth/login`, `/auth/callback`, `/auth/logout`, `/auth/me`）のテスト
2. 認証ミドルウェアのテスト（`requireAuth`）
3. 保護されたエンドポイントのテスト（認証あり・なしの両方）

これらを必ず実装してください。
